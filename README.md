# Diagnosticator

**Diagnosticator** — это система генерации и проведения медицинских тестов с использованием современных языковых моделей. Проект предназначен для преподавателей, студентов и специалистов в области медицины, а также для всех, кто хочет проверить или углубить свои знания в формате интерактивных тестов.

---

## Назначение проекта

- **Автоматическая генерация медицинских тестовых вопросов** с помощью языковой модели, обученной на медицинских данных.
- **Проведение тестирования** через современный и удобный веб-интерфейс.
- **Гибкая архитектура**: backend и frontend разделены, легко масштабируются и разворачиваются в Docker-контейнерах.

---

## Архитектура и основные модули

### 1. **Backend**

Реализован на Python с использованием FastAPI.

- **Модуль генерации вопросов (`backend/model/Model.py`):**
	- Формирует промпт для языковой модели на основе системного сообщения и случайных медицинских ключевых слов.
	- Асинхронно отправляет запрос к языковой модели (через HTTP API, например, llama.cpp сервер).
	- Извлекает из ответа корректный JSON с вопросом и вариантами ответов.
	- Логирует ошибки в файл `backend/logs/Model.log`.

- **API-сервер (`backend/api.py`):**
	- Эндпоинт `/v1/generate_question` возвращает сгенерированный вопрос в формате:
		```json
		{
			"question": "Текст вопроса",
			"right": "Правильный ответ",
			"wrong_1": "Неправильный ответ 1",
			"wrong_2": "Неправильный ответ 2",
			"wrong_3": "Неправильный ответ 3"
		}
		```
	- Включена поддержка CORS для взаимодействия с фронтендом.

- **Интеграция с языковой моделью:**
	- Используется llama.cpp сервер, запускаемый в отдельном контейнере.
	- Передача промпта и получение ответа происходит через HTTP API.

---

### 2. **Frontend**

Реализован на чистом HTML, CSS и JavaScript (без фреймворков).

- **Интерфейс теста (`frontend/index.html`, `frontend/style.css`, `frontend/quiz.js`):**
	- Красивый и адаптивный дизайн.
	- После загрузки первого вопроса следующий вопрос начинает генерироваться заранее.
	- Варианты ответов перемешиваются, правильный ответ подсвечивается зелёным, выбранный неправильный — красным.
	- Кнопка "Далее" становится активной только после генерации следующего вопроса.
	- Весь обмен с backend происходит через fetch-запросы к API.

---

### 3. **Docker и деплой**

- Для каждого компонента (модель, backend, frontend) подготовлены отдельные Dockerfile.
- В корне проекта находится `docker-compose.yml` для удобного запуска всех сервисов одной командой.
- Все сервисы автоматически связываются между собой через внутреннюю сеть Docker Compose.

---

## Быстрый старт

1. **Клонируйте репозиторий:**
	```bash
	git clone <адрес_репозитория>
	cd Diagnosticator
	```

2. **Постройте и запустите все сервисы:**
	```bash
	docker compose up --build
	```

3. **Откройте фронтенд:**
	- Перейдите в браузере по адресу [http://localhost:8081](http://localhost:8081).

---

## Описание логики работы

1. **Пользователь открывает веб-интерфейс.**
2. **Frontend** запрашивает первый вопрос у backend.
3. **Backend** вызывает языковую модель, формирует промпт с системным сообщением и случайными ключевыми словами, получает и парсит ответ.
4. **Frontend** отображает вопрос и варианты ответов, позволяет выбрать вариант.
5. После выбора ответа:
	- Правильный и выбранный ответы подсвечиваются.
	- Кнопка "Далее" становится активной, если следующий вопрос уже сгенерирован.
6. При нажатии "Далее" — отображается следующий вопрос, и процесс повторяется.

---

## Переменные среды и интеграции

- Все настройки (пути к файлам, адреса сервисов) задаются в соответствующих модулях и Dockerfile.
- Для интеграции с языковой моделью используется HTTP API (llama.cpp server).
- Для корректной работы CORS на backend уже настроен.

---

## Документация и поддержка

- Подробные комментарии и docstrings в коде.
- Пример системного промпта и ключевых слов — в файлах `backend/model/system_prompt.txt` и `backend/model/keywords.txt`.
- Для вопросов и предложений — создайте issue в репозитории.

---

## Лицензия

Проект является общественным достоянием.

---

**Diagnosticator** — современный инструмент для генерации и проведения медицинских тестов.